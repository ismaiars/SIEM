# =============================================================================
# SIEM OpenSource PyMES - Environment Variables
# =============================================================================
# Copy this file to .env and modify the values according to your environment
# cp .env.example .env
#
# IMPORTANT: Change all default passwords before deploying to production!
# =============================================================================

# =============================================================================
# GENERAL CONFIGURATION
# =============================================================================
PROJECT_NAME=siem-pymes
ENVIRONMENT=development
TIMEZONE=UTC
ORGANIZATION=tu-empresa
OWNER=security-team
COST_CENTER=cybersecurity
DEPLOYMENT_DATE=2024-01-01
CONTACT_EMAIL=admin@tu-empresa.com

# Domain and Network Configuration
DOMAIN_NAME=siem.local
EXTERNAL_IP=192.168.1.100
DNS_SERVERS=8.8.8.8,8.8.4.4

# =============================================================================
# ELASTIC STACK VERSIONS
# =============================================================================
ELASTIC_VERSION=8.11.0
KIBANA_VERSION=8.11.0
LOGSTASH_VERSION=8.11.0
FILEBEAT_VERSION=8.11.0

# =============================================================================
# WAZUH VERSIONS
# =============================================================================
WAZUH_VERSION=4.7.0

# =============================================================================
# OTHER SERVICES VERSIONS
# =============================================================================
SURICATA_VERSION=7.0.2
GRAFANA_VERSION=10.2.0
POSTGRES_VERSION=15-alpine
REDIS_VERSION=7-alpine
ELASTALERT_VERSION=2.15.0
NGINX_VERSION=1.25-alpine
PROMETHEUS_VERSION=2.47.0
NODE_EXPORTER_VERSION=1.6.1
ALERTMANAGER_VERSION=0.26.0

# =============================================================================
# ELASTICSEARCH CONFIGURATION
# =============================================================================
# Elasticsearch cluster settings
ELASTIC_CLUSTER_NAME=siem-pymes-cluster
ELASTIC_NODE_NAME=siem-node-01

# Elasticsearch security
ELASTIC_PASSWORD=SecureElasticPass123!

# Elasticsearch memory settings (adjust based on your system)
ES_HEAP_SIZE=2g
ES_MEM_LIMIT=4g

# =============================================================================
# KIBANA CONFIGURATION
# =============================================================================
KIBANA_PASSWORD=SecureKibanaPass123!
KIBANA_ENCRYPTION_KEY=a7a6311933d3503b89bc2dbc36572c01a6b9c9a0

# =============================================================================
# LOGSTASH CONFIGURATION
# =============================================================================
LOGSTASH_PASSWORD=SecureLogstashPass123!
LOGSTASH_HEAP_SIZE=1g

# =============================================================================
# FILEBEAT CONFIGURATION
# =============================================================================
FILEBEAT_PASSWORD=SecureFilebeatPass123!

# =============================================================================
# WAZUH CONFIGURATION
# =============================================================================
# Wazuh Manager API credentials
WAZUH_API_USERNAME=wazuh-wui
WAZUH_API_PASSWORD=SecureWazuhAPIPass123!
WAZUH_DASHBOARD_PASSWORD=SecureWazuhDashPass123!
WAZUH_INDEXER_PASSWORD=SecureWazuhIndexerPass123!

# Wazuh cluster configuration
WAZUH_CLUSTER_NAME=wazuh-cluster
WAZUH_CLUSTER_KEY=c98b62a9b6169ac5f67dae55ae4a9088
WAZUH_CLUSTER_NODE_NAME=wazuh-manager
WAZUH_CLUSTER_NODE_TYPE=master
WAZUH_CLUSTER_PORT=1516
WAZUH_CLUSTER_BIND_ADDR=0.0.0.0
WAZUH_CLUSTER_NODES=wazuh-manager
WAZUH_CLUSTER_DISABLED=yes

# Wazuh Indexer (OpenSearch)
WAZUH_INDEXER_HEAP_SIZE=2g
WAZUH_INDEXER_CLUSTER_NAME=wazuh-indexer-cluster
WAZUH_INDEXER_NODE_NAME=wazuh-indexer
WAZUH_INDEXER_NETWORK_HOST=0.0.0.0
WAZUH_INDEXER_HTTP_PORT=9200
WAZUH_INDEXER_TRANSPORT_PORT=9300

# =============================================================================
# GRAFANA CONFIGURATION
# =============================================================================
GRAFANA_USER=admin
GRAFANA_PASSWORD=SecureGrafanaPass123!

# =============================================================================
# POSTGRESQL CONFIGURATION
# =============================================================================
POSTGRES_DB=wazuh
POSTGRES_USER=wazuh_admin
POSTGRES_PASSWORD=SecurePostgresPass123!

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_PASSWORD=SecureRedisPass123!

# =============================================================================
# ELASTALERT CONFIGURATION
# =============================================================================
ELASTALERT_PASSWORD=SecureElastAlertPass123!

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================
NETWORK_SUBNET=172.20.0.0/16
GATEWAY_IP=172.20.0.1

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================
# Set to true to enable SSL/TLS (requires certificates)
SSL_ENABLED=true
SSL_VERIFICATION_MODE=certificate

# Certificate paths (relative to config directory)
SSL_CERTIFICATE_AUTHORITIES=/certs/ca/ca.crt
SSL_CERTIFICATE=/certs/elasticsearch/elasticsearch.crt
SSL_KEY=/certs/elasticsearch/elasticsearch.key

# =============================================================================
# MONITORING AND ALERTING
# =============================================================================
# Email configuration for alerts
SMTP_ENABLED=true
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_ADDRESS=siem-alerts@yourcompany.com
SMTP_FROM_NAME=SIEM PyMES Alerts
SMTP_TO=admin@yourcompany.com
SMTP_USE_TLS=true
SMTP_USE_SSL=false
SMTP_TIMEOUT=30

# Slack Integration
SLACK_ENABLED=true
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#security-alerts
SLACK_USERNAME=SIEM-Bot
SLACK_ICON_EMOJI=:warning:
SLACK_ALERT_LEVEL=medium

# Microsoft Teams Integration
TEAMS_ENABLED=false
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/YOUR/TEAMS/WEBHOOK
TEAMS_ALERT_LEVEL=high

# Telegram Integration
TELEGRAM_ENABLED=false
TELEGRAM_BOT_TOKEN=YOUR_BOT_TOKEN
TELEGRAM_CHAT_ID=YOUR_CHAT_ID
TELEGRAM_ALERT_LEVEL=critical

# PagerDuty Integration
PAGERDUTY_ENABLED=false
PAGERDUTY_SERVICE_KEY=YOUR_PAGERDUTY_SERVICE_KEY
PAGERDUTY_CLIENT_NAME=SIEM PyMES
PAGERDUTY_ALERT_LEVEL=critical

# Prometheus Monitoring
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
PROMETHEUS_SCRAPE_INTERVAL=15s
PROMETHEUS_EVALUATION_INTERVAL=15s
PROMETHEUS_RETENTION_TIME=15d
PROMETHEUS_RETENTION_SIZE=10GB

# Node Exporter
NODE_EXPORTER_ENABLED=true
NODE_EXPORTER_PORT=9100

# Elasticsearch Exporter
ES_EXPORTER_ENABLED=true
ES_EXPORTER_PORT=9114
ES_EXPORTER_ES_URI=http://elasticsearch:9200

# =============================================================================
# DEVELOPMENT/TESTING CONFIGURATION
# =============================================================================
# Set to true for development environment
DEVELOPMENT_MODE=true

# Enable debug logging
DEBUG_LOGGING=false

# Sample data generation
GENERATE_SAMPLE_DATA=false

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================
# Elasticsearch performance
ES_REFRESH_INTERVAL=30s
ES_NUMBER_OF_SHARDS=1
ES_NUMBER_OF_REPLICAS=0

# Logstash performance
LOGSTASH_PIPELINE_WORKERS=2
LOGSTASH_PIPELINE_BATCH_SIZE=125
LOGSTASH_PIPELINE_BATCH_DELAY=50

# =============================================================================
# DATA RETENTION
# =============================================================================
# Index lifecycle management
ILM_HOT_PHASE_DAYS=7
ILM_WARM_PHASE_DAYS=30
ILM_COLD_PHASE_DAYS=90
ILM_DELETE_PHASE_DAYS=365

# Log rotation
LOG_MAX_SIZE=100m
LOG_MAX_FILES=10

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
# Backup settings
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_LOCATION=/backups

# =============================================================================
# THREAT INTELLIGENCE INTEGRATION
# =============================================================================
# VirusTotal
VIRUSTOTAL_ENABLED=false
VIRUSTOTAL_API_KEY=your-virustotal-api-key
VIRUSTOTAL_RATE_LIMIT=4
VIRUSTOTAL_TIMEOUT=30

# Shodan
SHODAN_ENABLED=false
SHODAN_API_KEY=your-shodan-api-key
SHODAN_RATE_LIMIT=1
SHODAN_TIMEOUT=30

# MISP (Malware Information Sharing Platform)
MISP_ENABLED=false
MISP_URL=https://your-misp-instance.com
MISP_API_KEY=your-misp-api-key
MISP_VERIFY_SSL=true
MISP_TIMEOUT=30

# AlienVault OTX
OTX_ENABLED=false
OTX_API_KEY=your-otx-api-key
OTX_TIMEOUT=30

# IBM X-Force
XFORCE_ENABLED=false
XFORCE_API_KEY=your-xforce-api-key
XFORCE_PASSWORD=your-xforce-password
XFORCE_TIMEOUT=30

# =============================================================================
# COMPLIANCE AND AUDIT
# =============================================================================
# Compliance standards
COMPLIANCE_PCI_DSS=false
COMPLIANCE_HIPAA=false
COMPLIANCE_SOX=false
COMPLIANCE_GDPR=true

# Audit logging
AUDIT_LOGGING_ENABLED=true
AUDIT_LOG_LEVEL=INFO

# =============================================================================
# CUSTOM SIEM SETTINGS
# =============================================================================
# Alert Thresholds
FAILED_LOGIN_THRESHOLD=10
FAILED_LOGIN_TIMEFRAME=5m
BRUTE_FORCE_THRESHOLD=20
BRUTE_FORCE_TIMEFRAME=10m
MALWARE_ALERT_LEVEL=high
NETWORK_SCAN_THRESHOLD=100
NETWORK_SCAN_TIMEFRAME=1m

# Correlation Rules
CORRELATION_ENABLED=true
CORRELATION_WINDOW=5m
CORRELATION_MAX_EVENTS=1000

# Machine Learning
ML_ENABLED=false
ML_ANOMALY_DETECTION=false
ML_BEHAVIORAL_ANALYSIS=false
ML_TRAINING_PERIOD=7d
ML_SENSITIVITY=medium  # low, medium, high

# Threat Hunting
THREAT_HUNTING_ENABLED=true
THREAT_HUNTING_QUERIES_PATH=/opt/siem/threat-hunting
THREAT_HUNTING_SCHEDULE=0 */6 * * *  # Every 6 hours

# Custom tags for all logs
CUSTOM_TAGS=environment:development,project:siem-pymes

# Organization information
ORGANIZATION_NAME=Your Company Name
ORGANIZATION_DOMAIN=yourcompany.com

# =============================================================================
# DOCKER AND CONTAINER SETTINGS
# =============================================================================
# Docker Compose
COMPOSE_PROJECT_NAME=siem-pymes
COMPOSE_FILE=docker-compose.yml
COMPOSE_PROFILES=default

# Container Resource Limits
ELASTICSEARCH_MEM_LIMIT=8g
KIBANA_MEM_LIMIT=2g
LOGSTASH_MEM_LIMIT=4g
WAZUH_MANAGER_MEM_LIMIT=2g
WAZUH_INDEXER_MEM_LIMIT=4g
WAZUH_DASHBOARD_MEM_LIMIT=1g
GRAFANA_MEM_LIMIT=1g
POSTGRES_MEM_LIMIT=1g
REDIS_MEM_LIMIT=512m
NGINX_MEM_LIMIT=256m

# Container CPU Limits
ELASTICSEARCH_CPU_LIMIT=4
KIBANA_CPU_LIMIT=1
LOGSTASH_CPU_LIMIT=2
WAZUH_MANAGER_CPU_LIMIT=2
WAZUH_INDEXER_CPU_LIMIT=2
WAZUH_DASHBOARD_CPU_LIMIT=1
GRAFANA_CPU_LIMIT=1
POSTGRES_CPU_LIMIT=1
REDIS_CPU_LIMIT=0.5
NGINX_CPU_LIMIT=0.5

# Network interface for Suricata (auto-detect if empty)
SURICATA_INTERFACE=
SURICATA_HOME_NET=192.168.0.0/16,10.0.0.0/8,172.16.0.0/12
SURICATA_EXTERNAL_NET=!$HOME_NET

# Custom Elasticsearch plugins
ES_PLUGINS=

# Custom Kibana plugins
KIBANA_PLUGINS=

# =============================================================================
# NGINX CONFIGURATION
# =============================================================================
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024
NGINX_CLIENT_MAX_BODY_SIZE=100m
NGINX_PROXY_CONNECT_TIMEOUT=60s
NGINX_PROXY_SEND_TIMEOUT=60s
NGINX_PROXY_READ_TIMEOUT=60s

# Rate Limiting
NGINX_RATE_LIMIT=10r/s
NGINX_RATE_LIMIT_BURST=20
NGINX_CONN_LIMIT=10

# =============================================================================
# HEALTH CHECKS AND MONITORING
# =============================================================================
# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=60s

# =============================================================================
# PRODUCTION OVERRIDES
# =============================================================================
# Uncomment and modify these for production deployment

# Production passwords (CHANGE THESE!)
# ELASTIC_PASSWORD=YourSecureElasticPasswordHere!
# KIBANA_PASSWORD=YourSecureKibanaPasswordHere!
# WAZUH_API_PASSWORD=YourSecureWazuhPasswordHere!
# GRAFANA_PASSWORD=YourSecureGrafanaPasswordHere!
# POSTGRES_PASSWORD=YourSecurePostgresPasswordHere!
# REDIS_PASSWORD=YourSecureRedisPasswordHere!

# Production memory settings
# ES_HEAP_SIZE=4g
# ES_MEM_LIMIT=8g
# LOGSTASH_HEAP_SIZE=2g

# Production SSL settings
# SSL_ENABLED=true
# SSL_VERIFICATION_MODE=full

# Production monitoring
# DEBUG_LOGGING=false
# DEVELOPMENT_MODE=false

# =============================================================================
# END OF CONFIGURATION
# =============================================================================