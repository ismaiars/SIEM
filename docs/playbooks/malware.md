# Playbook de Respuesta a Incidentes - Malware

## ðŸ“‹ InformaciÃ³n del Playbook

| Campo | Valor |
|-------|-------|
| **ID del Playbook** | PB-003-MALWARE |
| **VersiÃ³n** | 1.0 |
| **Fecha de CreaciÃ³n** | Diciembre 2024 |
| **Ãšltima ActualizaciÃ³n** | Diciembre 2024 |
| **Autor** | Equipo de Respuesta a Incidentes |
| **ClasificaciÃ³n** | CONFIDENCIAL |
| **Tiempo Estimado** | 2-6 horas |

## ðŸŽ¯ Objetivo y Alcance

### Objetivo
Proporcionar una respuesta estructurada y efectiva ante incidentes de malware para minimizar el daÃ±o, contener la propagaciÃ³n y restaurar las operaciones normales de manera segura.

### Alcance
- Virus y gusanos informÃ¡ticos
- Troyanos y backdoors
- Rootkits y bootkits
- Adware y spyware
- Cryptominers
- Fileless malware
- Living off the land attacks

### Fuera del Alcance
- Ransomware (ver playbook especÃ­fico PB-001)
- APT campaigns (ver playbook especÃ­fico)
- Mobile malware
- IoT malware

## ðŸš¨ ClasificaciÃ³n de Severidad

### CrÃ­tico (P1)
- Malware en sistemas crÃ­ticos de producciÃ³n
- Rootkit con acceso administrativo
- ExfiltraciÃ³n de datos confirmada
- PropagaciÃ³n lateral activa
- AfectaciÃ³n a mÃ¡s del 25% de la infraestructura
- Compromiso de controladores de dominio

### Alto (P2)
- Malware en sistemas importantes
- Backdoor con acceso de usuario
- Intento de exfiltraciÃ³n detectado
- PropagaciÃ³n limitada
- AfectaciÃ³n del 10-25% de sistemas
- Compromiso de servidores de aplicaciones

### Medio (P3)
- Malware en estaciones de trabajo
- Adware/Spyware sin acceso crÃ­tico
- Sin evidencia de exfiltraciÃ³n
- PropagaciÃ³n contenida
- AfectaciÃ³n menor al 10% de sistemas
- Sistemas no crÃ­ticos comprometidos

### Bajo (P4)
- Malware detectado y bloqueado
- Sin compromiso confirmado
- Sistemas aislados afectados
- Sin propagaciÃ³n
- Impacto mÃ­nimo en operaciones

## ðŸ” Indicadores de Compromiso (IOCs)

### Indicadores de Sistema
```yaml
Procesos:
  - Procesos desconocidos o sospechosos
  - Alto uso de CPU/memoria sin causa aparente
  - Procesos que se reinician automÃ¡ticamente
  - Procesos con nombres similares a legÃ­timos
  - Procesos ejecutÃ¡ndose desde ubicaciones inusuales

Archivos:
  - Archivos en directorios temporales
  - Ejecutables con nombres aleatorios
  - Archivos con doble extensiÃ³n
  - Modificaciones en archivos del sistema
  - Archivos ocultos o con atributos especiales

Registro (Windows):
  - Claves de inicio modificadas
  - Servicios desconocidos instalados
  - Modificaciones en polÃ­ticas de seguridad
  - Cambios en configuraciÃ³n de firewall
  - Nuevas entradas en Run/RunOnce

Red:
  - Conexiones a IPs/dominios sospechosos
  - TrÃ¡fico de red inusual
  - ComunicaciÃ³n con C&C servers
  - Transferencias de datos no autorizadas
  - Conexiones en puertos no estÃ¡ndar
```

### Indicadores de Comportamiento
```yaml
Rendimiento:
  - Lentitud general del sistema
  - Aplicaciones que no responden
  - Reinicios inesperados
  - Pantallas azules (BSOD)
  - Congelamiento del sistema

Usuario:
  - Pop-ups inesperados
  - Cambios en pÃ¡gina de inicio
  - Nuevas barras de herramientas
  - Archivos desaparecidos o modificados
  - Configuraciones cambiadas sin autorizaciÃ³n

Seguridad:
  - Antivirus deshabilitado
  - Firewall desactivado
  - Actualizaciones bloqueadas
  - Herramientas de seguridad eliminadas
  - Alertas de seguridad ignoradas
```

## ðŸš€ Fase 1: DetecciÃ³n y AnÃ¡lisis Inicial

### 1.1 Fuentes de DetecciÃ³n

#### DetecciÃ³n AutomÃ¡tica
```yaml
Antivirus/EDR:
  - Alertas de malware detectado
  - Comportamiento sospechoso
  - AnÃ¡lisis heurÃ­stico
  - Sandboxing results

SIEM Rules:
  - AnomalÃ­as en procesos
  - Conexiones de red sospechosas
  - Modificaciones de archivos crÃ­ticos
  - Patrones de ataque conocidos

Network Monitoring:
  - IDS/IPS alerts
  - DNS sinkhole hits
  - Threat intelligence matches
  - Unusual traffic patterns

User Reports:
  - Comportamiento anÃ³malo del sistema
  - Pop-ups sospechosos
  - Rendimiento degradado
  - Archivos modificados
```

#### VerificaciÃ³n Manual
```bash
# Verificar procesos en ejecuciÃ³n
ps aux | grep -E "(tmp|temp|random)" | grep -v grep

# Verificar conexiones de red
netstat -an | grep ESTABLISHED | grep -v -E "(80|443|22|53)"

# Verificar archivos modificados recientemente
find /home -mtime -1 -type f | head -20
find /tmp -type f -executable

# Verificar logs del sistema
tail -100 /var/log/syslog | grep -E "(error|warning|suspicious)"

# Verificar integridad del sistema
sudo aide --check | head -20
```

### 1.2 AnÃ¡lisis Inicial

#### RecolecciÃ³n de Evidencias
```bash
# Crear directorio de investigaciÃ³n
mkdir -p /tmp/malware-incident-$(date +%Y%m%d-%H%M%S)
cd /tmp/malware-incident-$(date +%Y%m%d-%H%M%S)

# InformaciÃ³n del sistema
uname -a > system_info.txt
date > timestamp.txt
whoami > current_user.txt
id > user_permissions.txt

# Procesos en ejecuciÃ³n
ps auxf > process_tree.txt
ps aux --sort=-%cpu | head -20 > top_cpu_processes.txt
ps aux --sort=-%mem | head -20 > top_memory_processes.txt

# Conexiones de red
netstat -an > network_connections.txt
ss -tulpn > socket_stats.txt
lsof -i > open_files_network.txt

# Archivos y directorios sospechosos
find /tmp -type f -ls > tmp_files.txt
find /var/tmp -type f -ls > var_tmp_files.txt
find / -name "*.exe" -o -name "*.scr" -o -name "*.bat" 2>/dev/null > suspicious_executables.txt
```

#### AnÃ¡lisis de Malware
```bash
# Identificar archivos sospechosos
find /tmp -type f -executable -newer /tmp/infection_marker 2>/dev/null > suspicious_files.txt

# Calcular hashes
while read file; do
  if [ -f "$file" ]; then
    echo "File: $file"
    sha256sum "$file"
    md5sum "$file"
    echo "---"
  fi
done < suspicious_files.txt > file_hashes.txt

# Verificar en VirusTotal (si hay conectividad)
for hash in $(cut -d' ' -f1 file_hashes.txt | grep -E "^[a-f0-9]{64}$"); do
  echo "Checking hash: $hash"
  # curl -X GET "https://www.virustotal.com/vtapi/v2/file/report" --data "apikey=YOUR_API_KEY&resource=$hash"
done

# AnÃ¡lisis bÃ¡sico de archivos
file $(cat suspicious_files.txt) > file_types.txt
strings $(head -1 suspicious_files.txt) | head -50 > strings_analysis.txt
```

## ðŸ›¡ï¸ Fase 2: ContenciÃ³n

### 2.1 ContenciÃ³n Inmediata (0-30 minutos)

#### Aislamiento del Sistema
```bash
# OpciÃ³n 1: Desconectar de la red
sudo ip link set eth0 down

# OpciÃ³n 2: Bloquear todo el trÃ¡fico
sudo iptables -P INPUT DROP
sudo iptables -P OUTPUT DROP
sudo iptables -P FORWARD DROP

# OpciÃ³n 3: Desconectar fÃ­sicamente
# Desconectar cable de red

# Documentar el aislamiento
echo "$(date): Sistema aislado de la red" >> containment_log.txt
ip addr show >> containment_log.txt
```

#### Detener Procesos Maliciosos
```bash
# Identificar y detener procesos sospechosos
for pid in $(ps aux | grep -E "(suspicious_process|malware)" | grep -v grep | awk '{print $2}'); do
  echo "Killing process PID: $pid"
  sudo kill -9 $pid
  echo "$(date): Killed process $pid" >> containment_log.txt
done

# Verificar que los procesos se detuvieron
ps aux | grep -E "(suspicious_process|malware)" | grep -v grep
```

#### Preservar Evidencias
```bash
# Crear imagen de memoria (si es posible)
sudo dd if=/dev/mem of=memory_dump.raw bs=1M count=512 2>/dev/null

# Capturar estado actual del sistema
sudo netstat -an > network_state.txt
sudo ps auxf > process_state.txt
sudo lsof > open_files_state.txt

# Crear backup de logs crÃ­ticos
sudo cp /var/log/syslog syslog_backup.log
sudo cp /var/log/auth.log auth_backup.log
sudo cp /var/log/kern.log kern_backup.log
```

### 2.2 ContenciÃ³n Extendida (30 minutos - 2 horas)

#### Identificar PropagaciÃ³n
```bash
# Buscar en otros sistemas de la red
nmap -sS 192.168.1.0/24 -p 22,80,443,445 > network_scan.txt

# Verificar logs de otros sistemas
ssh admin@server1 "grep 'malware_indicator' /var/log/syslog"
ssh admin@server2 "ps aux | grep suspicious_process"

# Verificar compartidos de red
smbclient -L //fileserver -U username
```

#### Bloquear Comunicaciones Maliciosas
```bash
# Bloquear IPs maliciosas en firewall
echo "Blocking malicious IPs"
for ip in $(cat malicious_ips.txt); do
  sudo iptables -A INPUT -s $ip -j DROP
  sudo iptables -A OUTPUT -d $ip -j DROP
  echo "$(date): Blocked IP $ip" >> containment_log.txt
done

# Bloquear dominios maliciosos en DNS
for domain in $(cat malicious_domains.txt); do
  echo "0.0.0.0 $domain" | sudo tee -a /etc/hosts
  echo "$(date): Blocked domain $domain" >> containment_log.txt
done

# Actualizar reglas de proxy/firewall
sudo systemctl reload iptables
```

## ðŸ”¬ Fase 3: InvestigaciÃ³n Detallada

### 3.1 AnÃ¡lisis Forense

#### AnÃ¡lisis de Timeline
```bash
# Crear timeline de eventos
echo "=== TIMELINE DE EVENTOS ===" > timeline.txt
echo "" >> timeline.txt

# Archivos modificados en las Ãºltimas 24 horas
echo "Archivos modificados (Ãºltimas 24h):" >> timeline.txt
find / -mtime -1 -type f -ls 2>/dev/null | sort -k8,9 >> timeline.txt

# Logs de autenticaciÃ³n
echo "\nEventos de autenticaciÃ³n:" >> timeline.txt
grep "$(date +%b' '%d)" /var/log/auth.log >> timeline.txt

# Conexiones de red
echo "\nConexiones de red:" >> timeline.txt
grep "$(date +%b' '%d)" /var/log/syslog | grep -E "(connection|connect)" >> timeline.txt
```

#### AnÃ¡lisis de Persistencia
```bash
# Verificar mecanismos de persistencia
echo "=== ANÃLISIS DE PERSISTENCIA ===" > persistence_analysis.txt

# Servicios del sistema
echo "Servicios instalados:" >> persistence_analysis.txt
systemctl list-unit-files --type=service | grep enabled >> persistence_analysis.txt

# Tareas programadas
echo "\nCrontabs:" >> persistence_analysis.txt
for user in $(cut -f1 -d: /etc/passwd); do
  echo "User: $user" >> persistence_analysis.txt
  sudo crontab -u $user -l 2>/dev/null >> persistence_analysis.txt
done

# Archivos de inicio
echo "\nArchivos de inicio:" >> persistence_analysis.txt
ls -la /etc/init.d/ >> persistence_analysis.txt
ls -la /etc/systemd/system/ >> persistence_analysis.txt

# Variables de entorno
echo "\nVariables de entorno:" >> persistence_analysis.txt
env | grep -E "(PATH|LD_)" >> persistence_analysis.txt
```

### 3.2 AnÃ¡lisis de Impacto

#### Verificar Integridad de Datos
```bash
# Verificar checksums de archivos crÃ­ticos
echo "=== VERIFICACIÃ“N DE INTEGRIDAD ===" > integrity_check.txt

# Verificar archivos del sistema
sudo aide --check >> integrity_check.txt 2>&1

# Verificar archivos de configuraciÃ³n crÃ­ticos
for file in /etc/passwd /etc/shadow /etc/sudoers /etc/ssh/sshd_config; do
  echo "Checking: $file" >> integrity_check.txt
  ls -la $file >> integrity_check.txt
  sha256sum $file >> integrity_check.txt
done

# Verificar aplicaciones crÃ­ticas
which -a ssh sudo su >> integrity_check.txt
```

#### AnÃ¡lisis de ExfiltraciÃ³n
```bash
# Verificar transferencias de datos
echo "=== ANÃLISIS DE EXFILTRACIÃ“N ===" > exfiltration_analysis.txt

# Verificar conexiones salientes
echo "Conexiones salientes:" >> exfiltration_analysis.txt
netstat -an | grep -E "(80|443|21|22)" | grep ESTABLISHED >> exfiltration_analysis.txt

# Verificar logs de transferencias
echo "\nLogs de FTP/SFTP:" >> exfiltration_analysis.txt
grep -E "(upload|download|transfer)" /var/log/vsftpd.log 2>/dev/null >> exfiltration_analysis.txt
grep -E "(upload|download|transfer)" /var/log/auth.log >> exfiltration_analysis.txt

# Verificar uso de herramientas de transferencia
echo "\nHerramientas de transferencia:" >> exfiltration_analysis.txt
history | grep -E "(scp|rsync|curl|wget|nc)" >> exfiltration_analysis.txt
```

## ðŸ§¹ Fase 4: ErradicaciÃ³n

### 4.1 EliminaciÃ³n del Malware

#### Eliminar Archivos Maliciosos
```bash
# Eliminar archivos identificados como maliciosos
echo "=== ELIMINACIÃ“N DE MALWARE ===" > eradication_log.txt

while read file; do
  if [ -f "$file" ]; then
    echo "$(date): Deleting $file" >> eradication_log.txt
    sudo rm -f "$file"
    echo "Deleted: $file"
  fi
done < suspicious_files.txt

# Limpiar directorios temporales
echo "$(date): Cleaning temporary directories" >> eradication_log.txt
sudo rm -rf /tmp/*
sudo rm -rf /var/tmp/*

# Limpiar cachÃ©s
sudo rm -rf /var/cache/apt/archives/*
sudo rm -rf ~/.cache/*
```

#### Eliminar Persistencia
```bash
# Eliminar servicios maliciosos
for service in $(cat malicious_services.txt 2>/dev/null); do
  echo "$(date): Removing service $service" >> eradication_log.txt
  sudo systemctl stop $service
  sudo systemctl disable $service
  sudo rm -f /etc/systemd/system/$service.service
done

# Limpiar crontabs maliciosos
for user in $(cut -f1 -d: /etc/passwd); do
  sudo crontab -u $user -r 2>/dev/null
done

# Restaurar archivos de configuraciÃ³n
sudo cp /etc/passwd.backup /etc/passwd 2>/dev/null
sudo cp /etc/shadow.backup /etc/shadow 2>/dev/null
```

### 4.2 Fortalecimiento del Sistema

#### Aplicar Actualizaciones
```bash
# Actualizar sistema operativo
echo "$(date): Updating system" >> eradication_log.txt
sudo apt update
sudo apt upgrade -y

# Actualizar definiciones de antivirus
sudo freshclam
sudo systemctl restart clamav-daemon

# Verificar parches de seguridad
sudo apt list --upgradable | grep -i security
```

#### Configurar Controles de Seguridad
```bash
# Configurar firewall
sudo ufw --force reset
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh
sudo ufw enable

# Configurar fail2ban
sudo systemctl enable fail2ban
sudo systemctl start fail2ban

# Configurar auditorÃ­a
sudo systemctl enable auditd
sudo systemctl start auditd

# Configurar monitoreo de integridad
sudo aide --init
sudo mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db
```

## ðŸ”„ Fase 5: RecuperaciÃ³n

### 5.1 RestauraciÃ³n de Servicios

#### Verificar Integridad del Sistema
```bash
# Verificar servicios crÃ­ticos
echo "=== VERIFICACIÃ“N DE SERVICIOS ===" > recovery_verification.txt

for service in ssh apache2 mysql postgresql; do
  echo "Checking service: $service" >> recovery_verification.txt
  systemctl status $service >> recovery_verification.txt 2>&1
  echo "---" >> recovery_verification.txt
done

# Verificar conectividad de red
echo "\nVerificaciÃ³n de red:" >> recovery_verification.txt
ping -c 3 8.8.8.8 >> recovery_verification.txt
nslookup google.com >> recovery_verification.txt
```

#### Restaurar Conectividad
```bash
# Restaurar conectividad de red gradualmente
echo "$(date): Restoring network connectivity" >> recovery_log.txt

# Limpiar reglas de iptables
sudo iptables -F
sudo iptables -X
sudo iptables -t nat -F
sudo iptables -t nat -X

# Configurar reglas bÃ¡sicas de firewall
sudo iptables -P INPUT DROP
sudo iptables -P FORWARD DROP
sudo iptables -P OUTPUT ACCEPT

# Permitir trÃ¡fico local
sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A OUTPUT -o lo -j ACCEPT

# Permitir conexiones establecidas
sudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Permitir SSH
sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT

# Reactivar interfaz de red
sudo ip link set eth0 up
```

### 5.2 Monitoreo Post-RecuperaciÃ³n

#### Configurar Monitoreo Intensivo
```bash
# Configurar monitoreo de procesos
echo "=== CONFIGURACIÃ“N DE MONITOREO ===" > monitoring_setup.txt

# Script de monitoreo continuo
cat > /tmp/monitor_system.sh << 'EOF'
#!/bin/bash
while true; do
  echo "$(date): Monitoring check" >> /var/log/incident_monitoring.log
  
  # Verificar procesos sospechosos
  ps aux | grep -E "(tmp|temp|suspicious)" | grep -v grep >> /var/log/incident_monitoring.log
  
  # Verificar conexiones de red
  netstat -an | grep ESTABLISHED | grep -v -E "(22|80|443)" >> /var/log/incident_monitoring.log
  
  # Verificar archivos nuevos en /tmp
  find /tmp -type f -newer /tmp/monitoring_marker 2>/dev/null >> /var/log/incident_monitoring.log
  
  sleep 300  # Verificar cada 5 minutos
done
EOF

chmod +x /tmp/monitor_system.sh
touch /tmp/monitoring_marker

# Ejecutar monitoreo en background
nohup /tmp/monitor_system.sh &
```

#### Configurar Alertas
```bash
# Configurar alertas para actividad sospechosa
cat > /etc/cron.d/incident_monitoring << 'EOF'
# Monitoreo post-incidente
*/10 * * * * root /usr/local/bin/check_suspicious_activity.sh
EOF

# Script de verificaciÃ³n
cat > /usr/local/bin/check_suspicious_activity.sh << 'EOF'
#!/bin/bash
LOGFILE="/var/log/incident_monitoring.log"
ALERT_EMAIL="security@company.com"

# Verificar procesos sospechosos
if ps aux | grep -E "(malware|suspicious)" | grep -v grep; then
  echo "ALERT: Suspicious process detected" | mail -s "Security Alert" $ALERT_EMAIL
fi

# Verificar conexiones sospechosas
if netstat -an | grep ESTABLISHED | grep -v -E "(22|80|443|53)"; then
  echo "ALERT: Suspicious network connection" | mail -s "Security Alert" $ALERT_EMAIL
fi
EOF

chmod +x /usr/local/bin/check_suspicious_activity.sh
```

## ðŸ“Š Fase 6: DocumentaciÃ³n y Reporte

### 6.1 Reporte del Incidente

#### Resumen Ejecutivo
```yaml
Incidente: InfecciÃ³n por Malware
Fecha de DetecciÃ³n: [Fecha]
Tipo de Malware: [Tipo identificado]
Sistemas Afectados: [NÃºmero y descripciÃ³n]
Impacto: [DescripciÃ³n del impacto]
Estado: [Resuelto/En progreso]
Tiempo de ResoluciÃ³n: [Horas]
```

#### MÃ©tricas del Incidente
```yaml
DetecciÃ³n:
  - Tiempo de detecciÃ³n: _____ minutos
  - Fuente de detecciÃ³n: _____
  - Tipo de malware: _____
  - Familia/variante: _____

ContenciÃ³n:
  - Tiempo de contenciÃ³n: _____ minutos
  - Sistemas aislados: _____
  - PropagaciÃ³n detenida: SÃ­/No

ErradicaciÃ³n:
  - Tiempo de erradicaciÃ³n: _____ horas
  - Archivos eliminados: _____
  - Servicios limpiados: _____

RecuperaciÃ³n:
  - Tiempo de recuperaciÃ³n: _____ horas
  - Servicios restaurados: _____
  - Datos perdidos: SÃ­/No
  - Tiempo total de inactividad: _____ horas

Impacto:
  - Sistemas comprometidos: _____
  - Datos afectados: _____ GB
  - Usuarios impactados: _____
  - Costo estimado: $ _____
```

### 6.2 AnÃ¡lisis TÃ©cnico

#### Detalles del Malware
```yaml
AnÃ¡lisis del Malware:
  - Nombre/Familia: _____
  - Hash SHA256: _____
  - Hash MD5: _____
  - TamaÃ±o: _____ bytes
  - Tipo de archivo: _____
  - Compilador: _____
  - Fecha de compilaciÃ³n: _____

Comportamiento:
  - Vector de entrada: _____
  - Persistencia: _____
  - ComunicaciÃ³n C&C: _____
  - Capacidades: _____
  - TÃ©cnicas de evasiÃ³n: _____

IOCs Identificados:
  - Archivos: [Lista de archivos]
  - Procesos: [Lista de procesos]
  - Conexiones de red: [IPs/Dominios]
  - Claves de registro: [Claves modificadas]
  - Servicios: [Servicios creados]
```

## ðŸŽ“ Fase 7: Lecciones Aprendidas

### 7.1 AnÃ¡lisis de Efectividad

#### Controles que Funcionaron
- [ ] Antivirus detectÃ³ el malware
- [ ] EDR proporcionÃ³ visibilidad
- [ ] Monitoreo de red detectÃ³ comunicaciones
- [ ] Respuesta fue rÃ¡pida
- [ ] ContenciÃ³n fue efectiva
- [ ] No hubo propagaciÃ³n lateral
- [ ] Backups estaban disponibles

#### Controles que Fallaron
- [ ] Malware evadiÃ³ detecciÃ³n inicial
- [ ] PropagaciÃ³n no fue detectada
- [ ] Respuesta fue tardÃ­a
- [ ] Herramientas de seguridad fueron deshabilitadas
- [ ] Backups estaban comprometidos
- [ ] ComunicaciÃ³n fue inadecuada

### 7.2 Mejoras Recomendadas

#### Controles TÃ©cnicos
- [ ] Implementar EDR en todos los endpoints
- [ ] Mejorar detecciÃ³n de comportamiento
- [ ] Configurar sandboxing automÃ¡tico
- [ ] Implementar application whitelisting
- [ ] Mejorar segmentaciÃ³n de red
- [ ] Configurar threat hunting proactivo

#### Controles Administrativos
- [ ] Actualizar polÃ­ticas de seguridad
- [ ] Mejorar entrenamiento de usuarios
- [ ] Implementar gestiÃ³n de vulnerabilidades
- [ ] Mejorar procedimientos de respuesta
- [ ] Actualizar plan de continuidad

#### Controles de Proceso
- [ ] Automatizar respuesta inicial
- [ ] Mejorar comunicaciÃ³n de crisis
- [ ] Implementar mÃ©tricas de efectividad
- [ ] Crear playbooks especÃ­ficos por tipo
- [ ] Mejorar coordinaciÃ³n entre equipos

## ðŸ“ž Contactos de Emergencia

### Equipo de Respuesta
```yaml
Incident Commander:
  Nombre: [Nombre]
  TelÃ©fono: [TelÃ©fono]
  Email: [Email]

Analista de Malware:
  Nombre: [Nombre]
  TelÃ©fono: [TelÃ©fono]
  Email: [Email]

Administrador de Sistemas:
  Nombre: [Nombre]
  TelÃ©fono: [TelÃ©fono]
  Email: [Email]
```

### Contactos Externos
```yaml
Proveedores:
  - Antivirus: [Contacto]
  - EDR: [Contacto]
  - Threat Intelligence: [Contacto]

Autoridades:
  - CERT Nacional: [TelÃ©fono]
  - PolicÃ­a CibernÃ©tica: [TelÃ©fono]

Legal:
  - Abogado Corporativo: [TelÃ©fono]
  - Consultor de Privacidad: [TelÃ©fono]
```

## ðŸ“‹ Checklist de EjecuciÃ³n

### DetecciÃ³n y AnÃ¡lisis
- [ ] Alerta validada
- [ ] Severidad determinada
- [ ] Equipo notificado
- [ ] Evidencias recolectadas
- [ ] Malware identificado
- [ ] Alcance determinado

### ContenciÃ³n
- [ ] Sistema aislado
- [ ] Procesos maliciosos detenidos
- [ ] Evidencias preservadas
- [ ] PropagaciÃ³n verificada
- [ ] Comunicaciones bloqueadas

### InvestigaciÃ³n
- [ ] AnÃ¡lisis forense completado
- [ ] Timeline creado
- [ ] Persistencia analizada
- [ ] Impacto evaluado
- [ ] IOCs documentados

### ErradicaciÃ³n
- [ ] Malware eliminado
- [ ] Persistencia removida
- [ ] Sistema actualizado
- [ ] Controles fortalecidos

### RecuperaciÃ³n
- [ ] Servicios verificados
- [ ] Conectividad restaurada
- [ ] Monitoreo configurado
- [ ] Alertas implementadas

### Post-Incidente
- [ ] Reporte completado
- [ ] Lecciones documentadas
- [ ] Mejoras identificadas
- [ ] Entrenamiento actualizado
- [ ] Procedimientos mejorados

## ðŸ“š Herramientas y Referencias

### Herramientas de AnÃ¡lisis
- **AnÃ¡lisis de Malware**: VirusTotal, Hybrid Analysis, Cuckoo Sandbox
- **Forense**: Volatility, Autopsy, YARA, Sleuth Kit
- **Monitoreo**: OSSEC, Samhain, AIDE, Tripwire
- **Network Analysis**: Wireshark, tcpdump, Zeek

### Referencias
- [NIST Malware Incident Prevention](https://csrc.nist.gov/publications/detail/sp/800-83/rev-1/final)
- [SANS Malware Analysis](https://www.sans.org/white-papers/malware-analysis/)
- [MITRE ATT&CK Framework](https://attack.mitre.org/)
- [Malware Analysis Cookbook](https://www.wiley.com/en-us/Malware+Analyst%27s+Cookbook+and+DVD%3A+Tools+and+Techniques+for+Fighting+Malicious+Code-p-9780470613030)

---

**Documento clasificado como CONFIDENCIAL**  
**Ãšltima actualizaciÃ³n**: Diciembre 2024  
**PrÃ³xima revisiÃ³n**: Junio 2025  
**Aprobado por**: CISO